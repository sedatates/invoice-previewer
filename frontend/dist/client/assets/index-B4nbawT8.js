import{j as e,r as x}from"./main-CI7KXGrP.js";function O({onDownload:s,isDownloading:t=!1}){return e.jsx("header",{className:"bg-slate-800 border-b border-slate-700 px-6 py-4",children:e.jsxs("div",{className:"max-w-7xl mx-auto flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold",children:"Invoice Generator"}),e.jsx("p",{className:"text-slate-400 text-xs",children:"Create professional invoices"})]})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("button",{onClick:s,disabled:t,className:"px-4 py-2 bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 rounded-lg font-medium transition-all flex items-center gap-2 text-sm disabled:opacity-60 disabled:cursor-not-allowed",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),t?"Generating...":"Download PDF"]})})]})})}const B={minimal:{icon:"○",color:"from-slate-400 to-slate-500"},modern:{icon:"◆",color:"from-blue-400 to-blue-600"},classic:{icon:"◇",color:"from-amber-400 to-amber-600"},professional:{icon:"■",color:"from-gray-400 to-gray-600"},creative:{icon:"★",color:"from-purple-400 to-purple-600"},elegant:{icon:"◈",color:"from-rose-400 to-rose-600"},bold:{icon:"▲",color:"from-red-400 to-red-600"},simple:{icon:"●",color:"from-green-400 to-green-600"},shadcn:{icon:"◉",color:"from-zinc-400 to-zinc-600"}};function W({templates:s,selectedTemplate:t,onSelect:r,loading:a}){return a?e.jsxs("div",{className:"bg-slate-800 rounded-xl p-4 border border-slate-700",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-3",children:"Template"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:[1,2,3,4,5,6].map(n=>e.jsx("div",{className:"animate-pulse bg-slate-700 rounded-lg h-20"},n))})]}):e.jsxs("div",{className:"bg-slate-800 rounded-xl p-4 border border-slate-700",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-3",children:"Template"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:s.map(n=>{const l=n.id===t,o=B[n.id]||{icon:"□",color:"from-slate-400 to-slate-500"};return e.jsxs("button",{onClick:()=>r(n.id),className:`relative rounded-xl p-3 transition-all duration-200 ${l?"bg-gradient-to-br "+o.color+" ring-2 ring-white/30 scale-[1.02]":"bg-slate-700/50 hover:bg-slate-700 border border-slate-600 hover:border-slate-500"}`,title:n.label,children:[e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("span",{className:`text-2xl ${l?"text-white":"text-slate-400"}`,children:o.icon}),e.jsx("span",{className:`text-[11px] font-medium ${l?"text-white":"text-slate-300"}`,children:n.label})]}),l&&e.jsx("div",{className:"absolute top-1 right-1",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})})]},n.id)})})]})}function q({invoice:s,updateField:t}){return e.jsxs("div",{className:"bg-slate-800 rounded-xl p-4 border border-slate-700",children:[e.jsxs("h3",{className:"text-sm font-medium text-slate-300 mb-3 flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),"Your Company"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Company Name"}),e.jsx("input",{type:"text",value:s.companyName,onChange:r=>t("companyName",r.target.value),className:"w-full bg-slate-700 border border-slate-600 rounded-lg px-3 py-2 text-sm text-white placeholder-slate-400 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500/30",placeholder:"Acme Corporation"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Logo URL (optional)"}),e.jsx("input",{type:"text",value:s.companyLogo,onChange:r=>t("companyLogo",r.target.value),className:"w-full bg-slate-700 border border-slate-600 rounded-lg px-3 py-2 text-sm text-white placeholder-slate-400 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500/30",placeholder:"https://example.com/logo.png"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Address"}),e.jsx("textarea",{rows:2,value:s.companyAddress,onChange:r=>t("companyAddress",r.target.value),className:"w-full bg-slate-700 border border-slate-600 rounded-lg px-3 py-2 text-sm text-white placeholder-slate-400 resize-none focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500/30",placeholder:`123 Business Ave
San Francisco, CA 94102`})]})]})]})}function H({invoice:s,updateField:t}){return e.jsxs("div",{className:"bg-slate-800 rounded-xl p-4 border border-slate-700",children:[e.jsxs("h3",{className:"text-sm font-medium text-slate-300 mb-3 flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"Bill To"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Client Name"}),e.jsx("input",{type:"text",value:s.clientName,onChange:r=>t("clientName",r.target.value),className:"w-full bg-slate-700 border border-slate-600 rounded-lg px-3 py-2 text-sm text-white placeholder-slate-400 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500/30",placeholder:"John Smith"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Client Address"}),e.jsx("textarea",{rows:2,value:s.clientAddress,onChange:r=>t("clientAddress",r.target.value),className:"w-full bg-slate-700 border border-slate-600 rounded-lg px-3 py-2 text-sm text-white placeholder-slate-400 resize-none focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500/30",placeholder:`456 Client Street
New York, NY 10001`})]})]})]})}const I="https://cdn.jsdelivr.net/gh/sedatates/invoice-previewer@main",z="https://invoice-backend-production-c91b.up.railway.app",V=[{value:"$",label:"$ USD"},{value:"€",label:"€ EUR"},{value:"£",label:"£ GBP"},{value:"₺",label:"₺ TRY"}];function _({invoice:s,updateField:t}){return e.jsxs("div",{className:"bg-slate-800 rounded-xl p-4 border border-slate-700",children:[e.jsxs("h3",{className:"text-sm font-medium text-slate-300 mb-3 flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4 text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),"Invoice Details"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Invoice Number"}),e.jsx("input",{type:"text",value:s.invoiceNumber,onChange:r=>t("invoiceNumber",r.target.value),className:"w-full bg-slate-700 border border-slate-600 rounded-lg px-3 py-2 text-sm text-white focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500/30",placeholder:"INV-001"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Currency"}),e.jsx("select",{value:s.currency,onChange:r=>t("currency",r.target.value),className:"w-full bg-slate-700 border border-slate-600 rounded-lg px-3 py-2 text-sm text-white focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500/30",children:V.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Issue Date"}),e.jsx("input",{type:"date",value:s.issuedOn,onChange:r=>t("issuedOn",r.target.value),className:"w-full bg-slate-700 border border-slate-600 rounded-lg px-3 py-2 text-sm text-white focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500/30"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Due Date"}),e.jsx("input",{type:"date",value:s.dueOn,onChange:r=>t("dueOn",r.target.value),className:"w-full bg-slate-700 border border-slate-600 rounded-lg px-3 py-2 text-sm text-white focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500/30"})]})]})]})}function Y({items:s,addItem:t,removeItem:r,updateItem:a}){return e.jsxs("div",{className:"bg-slate-800 rounded-xl p-4 border border-slate-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h3",{className:"text-sm font-medium text-slate-300 flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4 text-amber-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})}),"Line Items"]}),e.jsxs("button",{onClick:t,className:"text-xs bg-slate-700 hover:bg-slate-600 px-3 py-1.5 rounded-lg transition-colors flex items-center gap-1",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add Item"]})]}),e.jsx("div",{className:"space-y-2",children:s.map((n,l)=>e.jsxs("div",{className:"bg-slate-700/50 rounded-lg p-3 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("input",{type:"text",value:n.description,onChange:o=>a(l,"description",o.target.value),placeholder:"Description",className:"flex-1 bg-slate-600 border border-slate-500 rounded px-2 py-1.5 text-sm text-white focus:outline-none focus:border-blue-500"}),e.jsx("button",{onClick:()=>r(l),className:"ml-2 text-slate-400 hover:text-red-400 transition-colors",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] text-slate-400",children:"Quantity"}),e.jsx("input",{type:"number",value:n.quantity,onChange:o=>a(l,"quantity",parseFloat(o.target.value)||0),min:"1",className:"w-full bg-slate-600 border border-slate-500 rounded px-2 py-1 text-sm text-white focus:outline-none focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] text-slate-400",children:"Rate"}),e.jsx("input",{type:"number",value:n.rate,onChange:o=>a(l,"rate",parseFloat(o.target.value)||0),min:"0",step:"0.01",className:"w-full bg-slate-600 border border-slate-500 rounded px-2 py-1 text-sm text-white focus:outline-none focus:border-blue-500"})]})]})]},l))})]})}function G({invoice:s,updateField:t}){return e.jsxs("div",{className:"bg-slate-800 rounded-xl p-4 border border-slate-700",children:[e.jsxs("h3",{className:"text-sm font-medium text-slate-300 mb-3 flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4 text-rose-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),"Tax & Notes"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Tax Rate (%)"}),e.jsx("input",{type:"number",value:s.taxRate,onChange:r=>t("taxRate",parseFloat(r.target.value)||0),className:"w-full bg-slate-700 border border-slate-600 rounded-lg px-3 py-2 text-sm text-white focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500/30",placeholder:"10",min:"0",max:"100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Notes"}),e.jsx("textarea",{rows:3,value:s.notes,onChange:r=>t("notes",r.target.value),className:"w-full bg-slate-700 border border-slate-600 rounded-lg px-3 py-2 text-sm text-white placeholder-slate-400 resize-none focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500/30",placeholder:"Payment terms, bank details, etc."})]})]})]})}var J=Object.prototype.toString,E=Array.isArray||function(t){return J.call(t)==="[object Array]"};function D(s){return typeof s=="function"}function K(s){return E(s)?"array":typeof s}function $(s){return s.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function P(s,t){return s!=null&&typeof s=="object"&&t in s}function Q(s,t){return s!=null&&typeof s!="object"&&s.hasOwnProperty&&s.hasOwnProperty(t)}var X=RegExp.prototype.test;function Z(s,t){return X.call(s,t)}var ee=/\S/;function te(s){return!Z(ee,s)}var se={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function re(s){return String(s).replace(/[&<>"'`=\/]/g,function(r){return se[r]})}var ae=/\s*/,ne=/\s+/,F=/\s*=/,le=/\s*\}/,oe=/#|\^|\/|>|\{|&|=|!/;function ie(s,t){if(!s)return[];var r=!1,a=[],n=[],l=[],o=!1,i=!1,c="",h=0;function d(){if(o&&!i)for(;l.length;)delete n[l.pop()];else l=[];o=!1,i=!1}var u,p,g;function y(w){if(typeof w=="string"&&(w=w.split(ne,2)),!E(w)||w.length!==2)throw new Error("Invalid tags: "+w);u=new RegExp($(w[0])+"\\s*"),p=new RegExp("\\s*"+$(w[1])),g=new RegExp("\\s*"+$("}"+w[1]))}y(t||N.tags);for(var m=new M(s),k,v,b,C,f,S;!m.eos();){if(k=m.pos,b=m.scanUntil(u),b)for(var R=0,L=b.length;R<L;++R)C=b.charAt(R),te(C)?(l.push(n.length),c+=C):(i=!0,r=!0,c+=" "),n.push(["text",C,k,k+1]),k+=1,C===`
`&&(d(),c="",h=0,r=!1);if(!m.scan(u))break;if(o=!0,v=m.scan(oe)||"name",m.scan(ae),v==="="?(b=m.scanUntil(F),m.scan(F),m.scanUntil(p)):v==="{"?(b=m.scanUntil(g),m.scan(le),m.scanUntil(p),v="&"):b=m.scanUntil(p),!m.scan(p))throw new Error("Unclosed tag at "+m.pos);if(v==">"?f=[v,b,k,m.pos,c,h,r]:f=[v,b,k,m.pos],h++,n.push(f),v==="#"||v==="^")a.push(f);else if(v==="/"){if(S=a.pop(),!S)throw new Error('Unopened section "'+b+'" at '+k);if(S[1]!==b)throw new Error('Unclosed section "'+S[1]+'" at '+k)}else v==="name"||v==="{"||v==="&"?i=!0:v==="="&&y(b)}if(d(),S=a.pop(),S)throw new Error('Unclosed section "'+S[1]+'" at '+m.pos);return de(ce(n))}function ce(s){for(var t=[],r,a,n=0,l=s.length;n<l;++n)r=s[n],r&&(r[0]==="text"&&a&&a[0]==="text"?(a[1]+=r[1],a[3]=r[3]):(t.push(r),a=r));return t}function de(s){for(var t=[],r=t,a=[],n,l,o=0,i=s.length;o<i;++o)switch(n=s[o],n[0]){case"#":case"^":r.push(n),a.push(n),r=n[4]=[];break;case"/":l=a.pop(),l[5]=n[2],r=a.length>0?a[a.length-1][4]:t;break;default:r.push(n)}return t}function M(s){this.string=s,this.tail=s,this.pos=0}M.prototype.eos=function(){return this.tail===""};M.prototype.scan=function(t){var r=this.tail.match(t);if(!r||r.index!==0)return"";var a=r[0];return this.tail=this.tail.substring(a.length),this.pos+=a.length,a};M.prototype.scanUntil=function(t){var r=this.tail.search(t),a;switch(r){case-1:a=this.tail,this.tail="";break;case 0:a="";break;default:a=this.tail.substring(0,r),this.tail=this.tail.substring(r)}return this.pos+=a.length,a};function T(s,t){this.view=s,this.cache={".":this.view},this.parent=t}T.prototype.push=function(t){return new T(t,this)};T.prototype.lookup=function(t){var r=this.cache,a;if(r.hasOwnProperty(t))a=r[t];else{for(var n=this,l,o,i,c=!1;n;){if(t.indexOf(".")>0)for(l=n.view,o=t.split("."),i=0;l!=null&&i<o.length;)i===o.length-1&&(c=P(l,o[i])||Q(l,o[i])),l=l[o[i++]];else l=n.view[t],c=P(n.view,t);if(c){a=l;break}n=n.parent}r[t]=a}return D(a)&&(a=a.call(this.view)),a};function j(){this.templateCache={_cache:{},set:function(t,r){this._cache[t]=r},get:function(t){return this._cache[t]},clear:function(){this._cache={}}}}j.prototype.clearCache=function(){typeof this.templateCache<"u"&&this.templateCache.clear()};j.prototype.parse=function(t,r){var a=this.templateCache,n=t+":"+(r||N.tags).join(":"),l=typeof a<"u",o=l?a.get(n):void 0;return o==null&&(o=ie(t,r),l&&a.set(n,o)),o};j.prototype.render=function(t,r,a,n){var l=this.getConfigTags(n),o=this.parse(t,l),i=r instanceof T?r:new T(r,void 0);return this.renderTokens(o,i,a,t,n)};j.prototype.renderTokens=function(t,r,a,n,l){for(var o="",i,c,h,d=0,u=t.length;d<u;++d)h=void 0,i=t[d],c=i[0],c==="#"?h=this.renderSection(i,r,a,n,l):c==="^"?h=this.renderInverted(i,r,a,n,l):c===">"?h=this.renderPartial(i,r,a,l):c==="&"?h=this.unescapedValue(i,r):c==="name"?h=this.escapedValue(i,r,l):c==="text"&&(h=this.rawValue(i)),h!==void 0&&(o+=h);return o};j.prototype.renderSection=function(t,r,a,n,l){var o=this,i="",c=r.lookup(t[1]);function h(p){return o.render(p,r,a,l)}if(c){if(E(c))for(var d=0,u=c.length;d<u;++d)i+=this.renderTokens(t[4],r.push(c[d]),a,n,l);else if(typeof c=="object"||typeof c=="string"||typeof c=="number")i+=this.renderTokens(t[4],r.push(c),a,n,l);else if(D(c)){if(typeof n!="string")throw new Error("Cannot use higher-order sections without the original template");c=c.call(r.view,n.slice(t[3],t[5]),h),c!=null&&(i+=c)}else i+=this.renderTokens(t[4],r,a,n,l);return i}};j.prototype.renderInverted=function(t,r,a,n,l){var o=r.lookup(t[1]);if(!o||E(o)&&o.length===0)return this.renderTokens(t[4],r,a,n,l)};j.prototype.indentPartial=function(t,r,a){for(var n=r.replace(/[^ \t]/g,""),l=t.split(`
`),o=0;o<l.length;o++)l[o].length&&(o>0||!a)&&(l[o]=n+l[o]);return l.join(`
`)};j.prototype.renderPartial=function(t,r,a,n){if(a){var l=this.getConfigTags(n),o=D(a)?a(t[1]):a[t[1]];if(o!=null){var i=t[6],c=t[5],h=t[4],d=o;c==0&&h&&(d=this.indentPartial(o,h,i));var u=this.parse(d,l);return this.renderTokens(u,r,a,d,n)}}};j.prototype.unescapedValue=function(t,r){var a=r.lookup(t[1]);if(a!=null)return a};j.prototype.escapedValue=function(t,r,a){var n=this.getConfigEscape(a)||N.escape,l=r.lookup(t[1]);if(l!=null)return typeof l=="number"&&n===N.escape?String(l):n(l)};j.prototype.rawValue=function(t){return t[1]};j.prototype.getConfigTags=function(t){return E(t)?t:t&&typeof t=="object"?t.tags:void 0};j.prototype.getConfigEscape=function(t){if(t&&typeof t=="object"&&!E(t))return t.escape};var N={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(s){A.templateCache=s},get templateCache(){return A.templateCache}},A=new j;N.clearCache=function(){return A.clearCache()};N.parse=function(t,r){return A.parse(t,r)};N.render=function(t,r,a,n){if(typeof t!="string")throw new TypeError('Invalid template! Template should be a "string" but "'+K(t)+'" was given as the first argument for mustache#render(template, view, partials)');return A.render(t,r,a,n)};N.escape=re;N.Scanner=M;N.Context=T;N.Writer=j;function ue({invoice:s,templateHtml:t,total:r}){const a=x.useRef(null),n=x.useMemo(()=>{const l=s.currency||"$";let o=0;const i=s.items.map(y=>{const m=y.quantity*y.rate;return o+=m,`<tr class="border-b border-gray-200">
          <td class="py-2 px-2">${y.description}</td>
          <td class="py-2 px-2 text-right">${y.quantity}</td>
          <td class="py-2 px-2 text-right">${l}${y.rate.toFixed(2)}</td>
          <td class="py-2 px-2 text-right">${l}${m.toFixed(2)}</td>
        </tr>`}).join(""),c=s.taxRate||0,h=o*(c/100),d=o+h,u=s.companyAddress.split(`
`).join("<br>"),p=`<strong>${s.clientName}</strong><br>${s.clientAddress.split(`
`).join("<br>")}`,g=s.notes?`<div class="mt-6 p-4 bg-gray-50 rounded text-[9px] text-gray-600">
            <p class="font-bold text-gray-500 uppercase text-[8px] mb-1">Notes</p>
            <p class="whitespace-pre-line">${s.notes}</p>
          </div>`:"";return{...s,hasLogo:!!s.companyLogo,companyLines:u,clientLines:p,itemsRows:i,subtotalFormatted:`${l}${o.toFixed(2)}`,taxRateLabel:c,taxAmountFormatted:`${l}${h.toFixed(2)}`,totalFormatted:`${l}${d.toFixed(2)}`,notesBlock:g}},[s]);return x.useEffect(()=>{if(!t||!a.current)return;const l=N.render(t,n),o=a.current.contentDocument||a.current.contentWindow?.document;o&&(o.open(),o.write(l),o.close())},[t,n]),e.jsxs("div",{className:"preview-panel bg-slate-800 rounded-xl border border-slate-700 overflow-hidden flex flex-col shadow-2xl",children:[e.jsxs("div",{className:"bg-slate-700/50 px-4 py-3 border-b border-slate-700 flex items-center justify-between shrink-0",children:[e.jsx("span",{className:"text-sm font-medium text-slate-300",children:"Preview"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("span",{className:"text-lg font-bold text-green-400",children:[s.currency,r.toFixed(2)]})})]}),e.jsx("div",{className:"flex-1 overflow-auto p-4 bg-slate-600/30 flex justify-center",children:e.jsx("div",{className:"bg-white rounded-lg shadow-2xl overflow-hidden",style:{width:595,minHeight:842},children:e.jsx("iframe",{ref:a,className:"w-full",style:{height:842,border:"none"}})})})]})}function he(){return"INV-"+String(Math.floor(Math.random()*9e3)+1e3)}function pe(){const s=new Date,t=new Date(s);return t.setDate(t.getDate()+30),{issuedOn:s.toISOString().split("T")[0],dueOn:t.toISOString().split("T")[0]}}const me=[{description:"Web Development",quantity:10,rate:150},{description:"UI/UX Design",quantity:5,rate:120}];function xe(){const s=pe(),[t,r]=x.useState({invoiceNumber:he(),companyName:"Acme Corporation",companyLogo:"",companyAddress:`123 Business Ave
San Francisco, CA 94102
hello@acme.com`,clientName:"John Smith",clientAddress:`456 Client Street
New York, NY 10001`,issuedOn:s.issuedOn,dueOn:s.dueOn,items:me,taxRate:10,currency:"$",notes:`Thank you for your business!
Payment via bank transfer.`}),a=x.useCallback((d,u)=>{r(p=>({...p,[d]:u}))},[]),n=x.useCallback(()=>{r(d=>({...d,items:[...d.items,{description:"",quantity:1,rate:0}]}))},[]),l=x.useCallback(d=>{r(u=>({...u,items:u.items.filter((p,g)=>g!==d)}))},[]),o=x.useCallback((d,u,p)=>{r(g=>({...g,items:g.items.map((y,m)=>m===d?{...y,[u]:p}:y)}))},[]),i=t.items.reduce((d,u)=>d+u.quantity*u.rate,0),c=i*(t.taxRate/100),h=i+c;return{invoice:t,updateField:a,addItem:n,removeItem:l,updateItem:o,subtotal:i,taxAmount:c,total:h}}function fe(){const[s,t]=x.useState([]),[r,a]=x.useState("minimal"),[n,l]=x.useState({}),[o,i]=x.useState(!0),[c,h]=x.useState(null);x.useEffect(()=>{async function u(){try{const p=await fetch(`${I}/index.json`);if(!p.ok)throw new Error("Failed to fetch templates");const g=await p.json();t(g.templates),i(!1)}catch(p){h(p instanceof Error?p.message:"Unknown error"),i(!1)}}u()},[]);const d=x.useCallback(async u=>{if(n[u])return n[u];const p=await fetch(`${I}/templates/${u}.html`);if(!p.ok)throw new Error(`Failed to fetch template: ${u}`);const g=await p.text();return l(y=>({...y,[u]:g})),g},[n]);return{templates:s,selectedTemplate:r,setSelectedTemplate:a,fetchTemplate:d,loading:o,error:c}}function ge(){const{invoice:s,updateField:t,addItem:r,removeItem:a,updateItem:n,total:l}=xe(),{templates:o,selectedTemplate:i,setSelectedTemplate:c,fetchTemplate:h,loading:d}=fe(),[u,p]=x.useState(null),[g,y]=x.useState(!0),[m,k]=x.useState(!1),v=x.useCallback(async()=>{if(!i)return;const b=f=>f.split(`
`).map(S=>S.trim()).filter(Boolean),C={template:i,data:{...s,companyAddress:b(s.companyAddress),clientAddress:b(s.clientAddress),items:s.items.map(f=>({...f,quantity:Number(f.quantity)||0,rate:Number(f.rate)||0}))}};try{k(!0);const f=await fetch(`${z}/render`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(C)});if(!f.ok){const w=await f.json().catch(()=>null),U=w?.error||w?.message||"Failed to generate PDF";throw new Error(U)}const S=await f.blob(),R=window.URL.createObjectURL(S),L=document.createElement("a");L.href=R,L.download=`invoice-${s.invoiceNumber||"document"}.pdf`,document.body.appendChild(L),L.click(),L.remove(),window.URL.revokeObjectURL(R)}catch(f){console.error("PDF download failed:",f),alert(f instanceof Error?f.message:"Failed to generate PDF")}finally{k(!1)}},[s,i]);return x.useEffect(()=>{async function b(){try{const C=await h(i);p(C)}catch(C){console.error("Failed to fetch template:",C)}}i&&b()},[i,h]),x.useEffect(()=>{!d&&o.length>0&&y(!1)},[d,o]),e.jsxs(e.Fragment,{children:[g&&e.jsx("div",{className:"fixed inset-0 bg-slate-900/80 flex items-center justify-center z-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-500 border-t-transparent mx-auto"}),e.jsx("p",{className:"text-slate-400 mt-4",children:"Loading templates..."})]})}),e.jsx(O,{onDownload:v,isDownloading:m}),e.jsx("main",{className:"max-w-7xl mx-auto p-6",children:e.jsxs("div",{className:"main-grid grid grid-cols-[400px_1fr] gap-6 items-start",children:[e.jsxs("div",{className:"editor-panel space-y-4 pr-2",children:[e.jsx(W,{templates:o,selectedTemplate:i,onSelect:c,loading:d}),e.jsx(q,{invoice:s,updateField:t}),e.jsx(H,{invoice:s,updateField:t}),e.jsx(_,{invoice:s,updateField:t}),e.jsx(Y,{items:s.items,addItem:r,removeItem:a,updateItem:n}),e.jsx(G,{invoice:s,updateField:t})]}),e.jsx(ue,{invoice:s,templateHtml:u,total:l})]})}),e.jsx("style",{children:`
        /* Sticky Preview Panel */
        .preview-panel {
          position: sticky;
          top: 24px;
          height: calc(100vh - 120px);
          align-self: flex-start;
        }

        /* Smooth scrollbar for editor */
        .editor-panel::-webkit-scrollbar {
          width: 6px;
        }
        .editor-panel::-webkit-scrollbar-track {
          background: transparent;
        }
        .editor-panel::-webkit-scrollbar-thumb {
          background: #475569;
          border-radius: 3px;
        }
        .editor-panel::-webkit-scrollbar-thumb:hover {
          background: #64748b;
        }

        @media (max-width: 1024px) {
          .main-grid {
            grid-template-columns: 1fr !important;
          }
          .preview-panel {
            position: relative;
            top: 0;
            height: auto;
          }
        }
      `})]})}export{ge as component};
